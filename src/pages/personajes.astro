---
import Layout from "../layouts/Layout.astro";
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
import CharacterCategorySection from "../components/CharacterCategorySection.astro";

const characters = (await getCollection("characters")).sort((a, b) =>
  (a.data.alias || a.data.name).localeCompare(b.data.alias || b.data.name),
);
---

<Layout
  title="Personajes"
  description="Galería completa de personajes de Superheroes INC. Descubre héroes, villanos y antihéroes del universo. Explora sus poderes, historias y afiliaciones."
  keywords="personajes superheroes inc, héroes, villanos, poderes, galería personajes, euroman, kamikaze, arkham"
>
  <section class="characters-page">
    <h1 class="page-title">Galería de Personajes</h1>
    <p class="intro-text">
      Conoce a los héroes y villanos que pueblan el universo de Superheroes INC.
    </p>

    {
      characters.filter((c) => c.data.category === "principales").length >
        0 && (
        <CharacterCategorySection
          title="Personajes Principales"
          intro="Protagonistas centrales de las tramas actuales. Sus decisiones mueven el mundo, salvarlo o destruirlo."
          characters={characters.filter(
            (c) => c.data.category === "principales",
          )}
        />
      )
    }

    {
      characters.filter(
        (c) => c.data.category === "secundarios" || !c.data.category,
      ).length > 0 && (
        <CharacterCategorySection
          title="Personajes Secundarios"
          intro="Aliados, rivales, personajes menos relevantes o inactivos y figuras clave que dan vida al universo."
          characters={characters.filter(
            (c) => c.data.category === "secundarios" || !c.data.category,
          )}
        />
      )
    }

    {
      characters.filter((c) => c.data.category === "genericos").length > 0 && (
        <CharacterCategorySection
          title="Personajes Genéricos"
          intro="Arquetipos y fuerzas comunes que pueblan las calles y organizaciones."
          characters={characters.filter((c) => c.data.category === "genericos")}
        />
      )
    }

    {
      characters.length === 0 && (
        <p class="empty-message">
          La base de datos de personajes está actualizándose...
        </p>
      )
    }
  </section>
</Layout>

<style>
  .characters-page {
    padding: var(--spacing-2xl) var(--spacing-lg);
    max-width: 1400px;
    margin: 0 auto;
  }

  .page-title {
    font-size: var(--text-5xl);
    font-weight: 800;
    text-align: center;
    margin-bottom: var(--spacing-md);
    color: var(--color-secondary);
    text-shadow: 3px 3px 0px var(--color-primary);
  }

  .intro-text {
    font-size: var(--text-xl);
    color: var(--color-text-light);
    margin-bottom: var(--spacing-2xl);
  }

  .empty-message {
    font-size: var(--text-xl);
    color: var(--color-text-light);
    padding: var(--spacing-2xl);
  }
</style>
